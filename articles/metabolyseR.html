<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="metabolyseR">
<title>Introduction • metabolyseR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction">
<meta property="og:description" content="metabolyseR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">metabolyseR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.15.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/metabolyseR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/pre_treatment.html">Metabolomics data pre-treatment</a>
    <a class="dropdown-item" href="../articles/modelling.html">Modelling and feature selection</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jasenfinch/metabolyseR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction</h1>
            <h3 data-toc-skip class="subtitle">metabolyseR v0.15.1</h3>
                        <h4 data-toc-skip class="author">Jasen
Finch</h4>
            
            <h4 data-toc-skip class="date">30 May, 2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jasenfinch/metabolyseR/blob/HEAD/vignettes/metabolyseR.Rmd" class="external-link"><code>vignettes/metabolyseR.Rmd</code></a></small>
      <div class="d-none name"><code>metabolyseR.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <em>metabolyseR</em> package provides a suite of methods that
encompass three elements of metabolomics data analysis:</p>
<ul>
<li>data pre-treatment</li>
<li>modelling / data mining</li>
<li>correlation analyses</li>
</ul>
<p>The package also distinguishes between the flexibility and simplicity
required for <strong>exploratory</strong> analyses compared to the
convenience needed for more complex <strong>routine</strong> analyses.
This is reflected in the underlying S4 object-oriented implementations
and associated methods defined within the package. It should be noted
that it is useful to understand the principles involved in using
<em>metabolyseR</em> for exploratory analyses to aid in extracting and
wrangling the results generated from routine analyses.</p>
<p>The following document will provide an introduction to the basic
usage of the package and includes how to create and use the base classes
that are the foundation of <em>metabolyseR</em>. This will be focused
around the applications for both exploratory and routine analyses. For
more detailed information on the individual analysis elements see their
associated vignette using:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/browseVignettes.html" class="external-link">browseVignettes</a></span><span class="op">(</span><span class="st">'metabolyseR'</span><span class="op">)</span></span></code></pre></div>
<p>There is also an example quick start analysis vignette provided.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">'quick_start'</span>,<span class="st">'metabolyseR'</span><span class="op">)</span></span></code></pre></div>
<p>Any issues, bugs or errors encountered while using the package should
be reported <a href="https://github.com/jasenfinch/metabolyseR/issues" class="external-link">here</a>.</p>
<p>The examples shown here will use the <code>abr1</code> data set from
the <a href="https://aberhrml.github.io/metaboData/" class="external-link">metaboData</a>
package (<code><a href="https://aberhrml.github.io/metaboData/reference/abr1.html" class="external-link">?metaboData::abr1</a></code>). This is a nominal mass
flow-injection mass spectrometry (FI-MS) fingerprinting data set from a
plant-pathogen infection time course experiment. The examples will also
include use of the pipe <code>%&gt;%</code> from the <a href="https://magrittr.tidyverse.org/" class="external-link">magrittr</a> package.</p>
<p>Firstly load the necessary packages:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jasenfinch.github.io/metabolyseR/">metabolyseR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://aberhrml.github.io/metaboData/" class="external-link">metaboData</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="parallel-processing">Parallel processing<a class="anchor" aria-label="anchor" href="#parallel-processing"></a>
</h2>
<p>The package supports parallel processing using the <a href="https://CRAN.R-project.org/package=future" class="external-link">future</a> package.</p>
<p>By default, processing by <code>metabolyseR</code> will be done
sequentially. However, parallel processing can be activated, prior to
analysis, by specifying a parallel back-end using <code><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan()</a></code>.
The following example specifies using the <code>multisession</code>
implementation (multiple background R sessions) with two worker
processes.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="va"><a href="https://future.futureverse.org/reference/multisession.html" class="external-link">multisession</a></span>,workers <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>See the future package <a href="https://CRAN.R-project.org/package=future" class="external-link">documentation</a> for
more information on the types of parallel implementations that are
available.</p>
</div>
<div class="section level2">
<h2 id="exploratory-analyses">Exploratory analyses<a class="anchor" aria-label="anchor" href="#exploratory-analyses"></a>
</h2>
<p>For exploratory analyses, simple questions of the data need to be
answered quickly, requiring few steps. Key requirements for any tool
used by investigators are that it should be both simple and
flexible.</p>
<p>In <em>metabolyseR</em>, the <code>AnalysisData</code> class is the
base S4 class that provides these requirements. The following sections
will give an overview of the basics in constructing and using these
objects as the base for analysis.</p>
<div class="section level3">
<h3 id="analysis-data">Analysis data<a class="anchor" aria-label="anchor" href="#analysis-data"></a>
</h3>
<p>We can firstly construct an <code>AnalysisData</code> object which
requires two data tables. The first is the metabolomic data where the
columns are the metabolome features, the rows the sample observations
and contains the abundance values. The second is the sample
meta-information where the row order should match to that of the
metabolome data table. Using the example data, his can be constructed
and assigned to the variable <code>d</code> by:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analysisData.html">analysisData</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">abr1</span><span class="op">$</span><span class="va">neg</span>,</span>
<span>                  info <span class="op">=</span> <span class="va">abr1</span><span class="op">$</span><span class="va">fact</span><span class="op">)</span></span></code></pre></div>
<p>Where <code>abr1$neg</code> is the negative ionisation mode data and
<code>abr1$fact</code> is the corresponding sample information. By
printing <code>d</code> we can view some basic information about our
data.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## AnalysisData object containing:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Samples: 120 </span></span>
<span><span class="co">## Features: 2000 </span></span>
<span><span class="co">## Info: 9</span></span></code></pre>
<p>We can also return the numbers of samples and numbers of features
respectively using the following:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/analysis-accessors.html">nSamples</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 120</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/analysis-accessors.html">nFeatures</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2000</span></span></code></pre>
<p>The data table can be extracted using the <code>dat</code>
method:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/analysis-accessors.html">dat</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 120 × 2,000</span></span></span>
<span><span class="co">##       N1    N2    N3    N4    N5    N6    N7    N8    N9   N10   N11   N12   N13</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>     0     0     0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>     0     0     0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>     0     0     0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>     0     0     0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>     0     0     0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>     0     0     0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>     0     0     0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>     0     0     0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>     0     0     0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>     0     0     0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 110 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1,987 more variables: N14 &lt;dbl&gt;, N15 &lt;dbl&gt;, N16 &lt;dbl&gt;, N17 &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   N18 &lt;dbl&gt;, N19 &lt;dbl&gt;, N20 &lt;dbl&gt;, N21 &lt;dbl&gt;, N22 &lt;dbl&gt;, N23 &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   N24 &lt;dbl&gt;, N25 &lt;dbl&gt;, N26 &lt;dbl&gt;, N27 &lt;dbl&gt;, N28 &lt;dbl&gt;, N29 &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   N30 &lt;dbl&gt;, N31 &lt;dbl&gt;, N32 &lt;dbl&gt;, N33 &lt;dbl&gt;, N34 &lt;dbl&gt;, N35 &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   N36 &lt;dbl&gt;, N37 &lt;dbl&gt;, N38 &lt;dbl&gt;, N39 &lt;dbl&gt;, N40 &lt;dbl&gt;, N41 &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   N42 &lt;dbl&gt;, N43 &lt;dbl&gt;, N44 &lt;dbl&gt;, N45 &lt;dbl&gt;, N46 &lt;dbl&gt;, N47 &lt;dbl&gt;, …</span></span></span></code></pre>
<p>Or alternatively, can be used to assign a new data table:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/analysis-accessors.html">dat</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">abr1</span><span class="op">$</span><span class="va">pos</span></span>
<span><span class="va">d</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## AnalysisData object containing:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Samples: 120 </span></span>
<span><span class="co">## Features: 2000 </span></span>
<span><span class="co">## Info: 9</span></span></code></pre>
<p>The sample information table can be extracted using the
<code>sinfo</code> method:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/analysis-accessors.html">sinfo</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 120 × 9</span></span></span>
<span><span class="co">##    injorder pathcdf              filecdf name.org remark name    rep day   class</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>        1 C:/Xcalibur/ANDI-LT… 01.cdf  12_2     ok     12_2      2 2         2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>        2 C:/Xcalibur/ANDI-LT… 02.cdf  13_3     ok     13_4      3 3         3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>        3 C:/Xcalibur/ANDI-LT… 03.cdf  15_4     ok     15_5      5 4         4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>        4 C:/Xcalibur/ANDI-LT… 04.cdf  12_1     ok     12_2      2 1         1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>        5 C:/Xcalibur/ANDI-LT… 05.cdf  12_2     ok     12_2      2 2         2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>        6 C:/Xcalibur/ANDI-LT… 06.cdf  11_1     ok     11_2      1 1         1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>        7 C:/Xcalibur/ANDI-LT… 07.cdf  14_2     ok     14_3      4 2         2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>        8 C:/Xcalibur/ANDI-LT… 08.cdf  11_4     ok     11_5      1 4         4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>        9 C:/Xcalibur/ANDI-LT… 09.cdf  13_H     ok     13_H      3 H         6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>       10 C:/Xcalibur/ANDI-LT… 10.cdf  15_H     ok     15_H      5 H         6</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 110 more rows</span></span></span></code></pre>
<p>And similarly used to assign a new sample information table:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/analysis-accessors.html">sinfo</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">abr1</span><span class="op">$</span><span class="va">fact</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">d</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## AnalysisData object containing:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Samples: 120 </span></span>
<span><span class="co">## Features: 2000 </span></span>
<span><span class="co">## Info: 2</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="sample-information">Sample information<a class="anchor" aria-label="anchor" href="#sample-information"></a>
</h3>
<p>There are a number of methods that provide utility for querying and
altering the sample information within an <code>AnalysisData</code>
object. These methods are all named with the prefix <code>cls</code> and
include:</p>
<ul>
<li><code>clsAdd</code></li>
<li><code>clsArrange</code></li>
<li><code>clsAvailable</code></li>
<li><code>clsExtract</code></li>
<li><code>clsRemove</code></li>
<li><code>clsRename</code></li>
<li><code>clsReplace</code></li>
</ul>
<p>The names of the available sample information columns can be shown
using <code><a href="../reference/cls.html">clsAvailable()</a></code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cls.html">clsAvailable</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "injorder" "pathcdf"  "filecdf"  "name.org" "remark"   "name"     "rep"     </span></span>
<span><span class="co">## [8] "day"      "class"</span></span></code></pre>
<p>A given column can be extracted using <code><a href="../reference/cls.html">clsExtract()</a></code>.
Here, the <code>day</code> column is extracted.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cls.html">clsExtract</a></span><span class="op">(</span><span class="va">d</span>,cls <span class="op">=</span> <span class="st">'day'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   [1] 2 3 4 1 2 1 2 4 H H 4 5 1 2 H 5 3 3 2 H 4 3 5 4 H H 3 H H 1 1 1 5 5 3 4 H</span></span>
<span><span class="co">##  [38] 1 5 5 1 2 4 3 2 4 3 2 5 4 4 H 3 4 2 4 4 1 5 4 4 1 1 H 3 2 H 3 3 1 2 H H 2</span></span>
<span><span class="co">##  [75] 3 5 3 2 5 2 4 3 H 2 3 2 1 1 4 5 3 2 1 H 5 2 4 H 1 4 4 1 1 5 H 5 1 3 3 5 5</span></span>
<span><span class="co">## [112] 5 3 2 5 H 5 H 2 1</span></span>
<span><span class="co">## Levels: 1 2 3 4 5 H</span></span></code></pre>
<p>Sample class frequencies could then be computed.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cls.html">clsExtract</a></span><span class="op">(</span><span class="va">d</span>,cls <span class="op">=</span> <span class="st">'day'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## .</span></span>
<span><span class="co">##  1  2  3  4  5  H </span></span>
<span><span class="co">## 20 20 20 20 20 20</span></span></code></pre>
<p>It can be seen that there are 20 samples available in each class.</p>
<p>Another example is the addition of a new sample information column.
In the following, a column called <code>new_class</code> will be added
with all samples labelled <code>1</code>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cls.html">clsAdd</a></span><span class="op">(</span><span class="va">d</span>,cls <span class="op">=</span> <span class="st">'new_class'</span>,value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="../reference/analysis-accessors.html">nSamples</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/cls.html">clsAvailable</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "injorder"  "pathcdf"   "filecdf"   "name.org"  "remark"    "name"     </span></span>
<span><span class="co">##  [7] "rep"       "day"       "class"     "new_class"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="keeping-removing-samples-or-features">Keeping / removing samples or features<a class="anchor" aria-label="anchor" href="#keeping-removing-samples-or-features"></a>
</h3>
<p>Samples or features can easily be kept or removed from an
<code>AnalysisData</code> object as is most convenient.</p>
<p>Below can be seen the first 6 sample indexes in the
<code>injorder</code> column of the sample information.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/cls.html">clsExtract</a></span><span class="op">(</span>cls <span class="op">=</span> <span class="st">'injorder'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1 2 3 4 5 6</span></span></code></pre>
<p>Only these samples could be kept using:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/keep.html">keepSamples</a></span><span class="op">(</span>idx <span class="op">=</span> <span class="st">'injorder'</span>,samples <span class="op">=</span> <span class="va">samples</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## AnalysisData object containing:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Samples: 6 </span></span>
<span><span class="co">## Features: 2000 </span></span>
<span><span class="co">## Info: 10</span></span></code></pre>
<p>Or removed using:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/remove.html">removeSamples</a></span><span class="op">(</span>idx <span class="op">=</span> <span class="st">'injorder'</span>,samples <span class="op">=</span> <span class="va">samples</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## AnalysisData object containing:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Samples: 114 </span></span>
<span><span class="co">## Features: 2000 </span></span>
<span><span class="co">## Info: 10</span></span></code></pre>
<p>The process is very similar for keeping or removing specific
metabolome features from the data table. Below can be seen the first 6
feature names in the data table.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feat</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/analysis-accessors.html">features</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">feat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "N1" "N2" "N3" "N4" "N5" "N6"</span></span></code></pre>
<p>Only these features can be kept using:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/keep.html">keepFeatures</a></span><span class="op">(</span>features <span class="op">=</span> <span class="va">feat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## AnalysisData object containing:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Samples: 120 </span></span>
<span><span class="co">## Features: 6 </span></span>
<span><span class="co">## Info: 10</span></span></code></pre>
<p>Or to remove these features:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/remove.html">removeFeatures</a></span><span class="op">(</span>features <span class="op">=</span> <span class="va">feat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## AnalysisData object containing:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Samples: 120 </span></span>
<span><span class="co">## Features: 1994 </span></span>
<span><span class="co">## Info: 10</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="routine-analyses">Routine analyses<a class="anchor" aria-label="anchor" href="#routine-analyses"></a>
</h2>
<p>Routine analyses are those that are often made up of numerous steps
where parameters have likely already been previously established. The
emphasis here is on convenience with as little code as possible
required. In these analyses, the necessary analysis elements, order and
parameters are first prepared and then the analysis routine subsequently
performed in a single step. This section will introduce how this type of
analysis can be performed using <em>metabolyseR</em> and will include
four main topics:</p>
<ul>
<li>analysis parameter selection</li>
<li>performing an analysis</li>
<li>performing a re-analysis</li>
<li>extracting analysis results</li>
</ul>
<div class="section level3">
<h3 id="analysis-parameters">Analysis parameters<a class="anchor" aria-label="anchor" href="#analysis-parameters"></a>
</h3>
<p>Parameter selection is the fundamental aspect for performing routine
analyses using <em>metabolyseR</em> and will be the step requiring the
most input from the user. The parameters for an analysis are stored in
an S4 object of class <code>AnalysisParameters</code> containing the
relevant parameters of the selected analysis elements.</p>
<p>The parameters have been named so that they denote the same
functionality commonly across all analysis element methods.
<strong>Discussion of the specific parameters can be found withing the
vignettes of the relevant analysis elements.</strong> These can be
accessed using:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/browseVignettes.html" class="external-link">browseVignettes</a></span><span class="op">(</span><span class="st">'metabolyseR'</span><span class="op">)</span></span></code></pre></div>
<p>There are several ways to specify the parameters to use for analysis.
The first is programatically and the second is through the use of the
YAML format.</p>
<div class="section level4">
<h4 id="programatic-specification">Programatic specification<a class="anchor" aria-label="anchor" href="#programatic-specification"></a>
</h4>
<p>The available analysis elements can be shown using:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/analysisElements.html">analysisElements</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "pre-treatment" "modelling"     "correlations"</span></span></code></pre>
<p>The <code><a href="../reference/analysisParameters.html">analysisParameters()</a></code> function can be used to create
an <code>AnalysisParameters</code> object containing the default
parameters. For example, the code below will return default parameters
for all the <em>metabolyseR</em> analysis elements.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analysisParameters.html">analysisParameters</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #BBBB00;">Parameters:</span></span></span>
<span><span class="co">## pre-treatment</span></span>
<span><span class="co">##  QC</span></span>
<span><span class="co">##      occupancyFilter</span></span>
<span><span class="co">##          cls = class</span></span>
<span><span class="co">##          QCidx = QC</span></span>
<span><span class="co">##          occupancy = 2/3</span></span>
<span><span class="co">##      impute</span></span>
<span><span class="co">##          cls = class</span></span>
<span><span class="co">##          QCidx = QC</span></span>
<span><span class="co">##          occupancy = 2/3</span></span>
<span><span class="co">##          parallel = variables</span></span>
<span><span class="co">##          seed = 1234</span></span>
<span><span class="co">##      RSDfilter</span></span>
<span><span class="co">##          cls = class</span></span>
<span><span class="co">##          QCidx = QC</span></span>
<span><span class="co">##          RSDthresh = 50</span></span>
<span><span class="co">##      removeQC</span></span>
<span><span class="co">##          cls = class</span></span>
<span><span class="co">##          QCidx = QC</span></span>
<span><span class="co">##  occupancyFilter</span></span>
<span><span class="co">##      maximum</span></span>
<span><span class="co">##          cls = class</span></span>
<span><span class="co">##          occupancy = 2/3</span></span>
<span><span class="co">##  impute</span></span>
<span><span class="co">##      class</span></span>
<span><span class="co">##          cls = class</span></span>
<span><span class="co">##          occupancy = 2/3</span></span>
<span><span class="co">##          seed = 1234</span></span>
<span><span class="co">##  transform</span></span>
<span><span class="co">##      TICnorm</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## modelling</span></span>
<span><span class="co">##  randomForest</span></span>
<span><span class="co">##      cls = class</span></span>
<span><span class="co">##      rf = list()</span></span>
<span><span class="co">##      reps = 1</span></span>
<span><span class="co">##      binary = FALSE</span></span>
<span><span class="co">##      comparisons = list()</span></span>
<span><span class="co">##      perm = 0</span></span>
<span><span class="co">##      returnModels = FALSE</span></span>
<span><span class="co">##      seed = 1234</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## correlations</span></span>
<span><span class="co">##  method = pearson</span></span>
<span><span class="co">##  pAdjustMethod = bonferroni</span></span>
<span><span class="co">##  corPvalue = 0.05</span></span>
<span><span class="co">##  minCoef = 0</span></span>
<span><span class="co">##  maxCor = Inf</span></span></code></pre>
<p>To retrieve parameters for a subset of analysis elements the
following can be run, returning parameters for only the pre-treatment
and modelling elements.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analysisParameters.html">analysisParameters</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'pre-treatment'</span>,<span class="st">'modelling'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #BBBB00;">Parameters:</span></span></span>
<span><span class="co">## pre-treatment</span></span>
<span><span class="co">##  QC</span></span>
<span><span class="co">##      occupancyFilter</span></span>
<span><span class="co">##          cls = class</span></span>
<span><span class="co">##          QCidx = QC</span></span>
<span><span class="co">##          occupancy = 2/3</span></span>
<span><span class="co">##      impute</span></span>
<span><span class="co">##          cls = class</span></span>
<span><span class="co">##          QCidx = QC</span></span>
<span><span class="co">##          occupancy = 2/3</span></span>
<span><span class="co">##          parallel = variables</span></span>
<span><span class="co">##          seed = 1234</span></span>
<span><span class="co">##      RSDfilter</span></span>
<span><span class="co">##          cls = class</span></span>
<span><span class="co">##          QCidx = QC</span></span>
<span><span class="co">##          RSDthresh = 50</span></span>
<span><span class="co">##      removeQC</span></span>
<span><span class="co">##          cls = class</span></span>
<span><span class="co">##          QCidx = QC</span></span>
<span><span class="co">##  occupancyFilter</span></span>
<span><span class="co">##      maximum</span></span>
<span><span class="co">##          cls = class</span></span>
<span><span class="co">##          occupancy = 2/3</span></span>
<span><span class="co">##  impute</span></span>
<span><span class="co">##      class</span></span>
<span><span class="co">##          cls = class</span></span>
<span><span class="co">##          occupancy = 2/3</span></span>
<span><span class="co">##          seed = 1234</span></span>
<span><span class="co">##  transform</span></span>
<span><span class="co">##      TICnorm</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## modelling</span></span>
<span><span class="co">##  randomForest</span></span>
<span><span class="co">##      cls = class</span></span>
<span><span class="co">##      rf = list()</span></span>
<span><span class="co">##      reps = 1</span></span>
<span><span class="co">##      binary = FALSE</span></span>
<span><span class="co">##      comparisons = list()</span></span>
<span><span class="co">##      perm = 0</span></span>
<span><span class="co">##      returnModels = FALSE</span></span>
<span><span class="co">##      seed = 1234</span></span></code></pre>
<p>The <code>changeParameter()</code> function can be used to uniformly
change these parameters across all of the selected methods. The example
below changes the defaults of all the parameters named <code>cls</code>
from the default <code>class</code> to <code>day</code>.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analysisParameters.html">analysisParameters</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">changeParameter</span><span class="op">(</span><span class="va">p</span>,<span class="st">'cls'</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">'day'</span></span>
<span><span class="va">p</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #BBBB00;">Parameters:</span></span></span>
<span><span class="co">## pre-treatment</span></span>
<span><span class="co">##  QC</span></span>
<span><span class="co">##      occupancyFilter</span></span>
<span><span class="co">##          cls = day</span></span>
<span><span class="co">##          QCidx = QC</span></span>
<span><span class="co">##          occupancy = 2/3</span></span>
<span><span class="co">##      impute</span></span>
<span><span class="co">##          cls = day</span></span>
<span><span class="co">##          QCidx = QC</span></span>
<span><span class="co">##          occupancy = 2/3</span></span>
<span><span class="co">##          parallel = variables</span></span>
<span><span class="co">##          seed = 1234</span></span>
<span><span class="co">##      RSDfilter</span></span>
<span><span class="co">##          cls = day</span></span>
<span><span class="co">##          QCidx = QC</span></span>
<span><span class="co">##          RSDthresh = 50</span></span>
<span><span class="co">##      removeQC</span></span>
<span><span class="co">##          cls = day</span></span>
<span><span class="co">##          QCidx = QC</span></span>
<span><span class="co">##  occupancyFilter</span></span>
<span><span class="co">##      maximum</span></span>
<span><span class="co">##          cls = day</span></span>
<span><span class="co">##          occupancy = 2/3</span></span>
<span><span class="co">##  impute</span></span>
<span><span class="co">##      class</span></span>
<span><span class="co">##          cls = day</span></span>
<span><span class="co">##          occupancy = 2/3</span></span>
<span><span class="co">##          seed = 1234</span></span>
<span><span class="co">##  transform</span></span>
<span><span class="co">##      TICnorm</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## modelling</span></span>
<span><span class="co">##  randomForest</span></span>
<span><span class="co">##      cls = day</span></span>
<span><span class="co">##      rf = list()</span></span>
<span><span class="co">##      reps = 1</span></span>
<span><span class="co">##      binary = FALSE</span></span>
<span><span class="co">##      comparisons = list()</span></span>
<span><span class="co">##      perm = 0</span></span>
<span><span class="co">##      returnModels = FALSE</span></span>
<span><span class="co">##      seed = 1234</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## correlations</span></span>
<span><span class="co">##  method = pearson</span></span>
<span><span class="co">##  pAdjustMethod = bonferroni</span></span>
<span><span class="co">##  corPvalue = 0.05</span></span>
<span><span class="co">##  minCoef = 0</span></span>
<span><span class="co">##  maxCor = Inf</span></span></code></pre>
<p>Alternatively the parameters of a specific analysis elements can be
targeted using the <code>elements</code> argument. The following will
only alter the <code>cls</code> parameter back to <code>class</code> for
the pre-treatment element parameters:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">changeParameter</span><span class="op">(</span><span class="va">p</span>,<span class="st">'cls'</span>,elements <span class="op">=</span> <span class="st">'pre-treatment'</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">'class'</span></span></code></pre></div>
<p>Parameters can be extracted from the <code>AnalysisParameters</code>
class using the <code><a href="../reference/parameters.html">parameters()</a></code> function for a specified
element.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/parameters.html">parameters</a></span><span class="op">(</span><span class="va">p</span>,<span class="st">'correlations'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $method</span></span>
<span><span class="co">## [1] "pearson"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $pAdjustMethod</span></span>
<span><span class="co">## [1] "bonferroni"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $corPvalue</span></span>
<span><span class="co">## [1] 0.05</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $minCoef</span></span>
<span><span class="co">## [1] 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $maxCor</span></span>
<span><span class="co">## [1] Inf</span></span></code></pre>
<p>Each analysis element has a function for returning default parameters
for specific methods. These include
<code><a href="../reference/pre-treatment-parameters.html">preTreatmentParameters()</a></code>,
<code><a href="../reference/modelling-parameters.html">modellingParameters()</a></code> and
<code>correlationParameters()</code>. Each returns a list of the default
parameters for a specified methods as shown in the example for
<code><a href="../reference/modelling-parameters.html">modellingParameters()</a></code> below.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/modelling-parameters.html">modellingParameters</a></span><span class="op">(</span><span class="st">'anova'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $anova</span></span>
<span><span class="co">## $anova$cls</span></span>
<span><span class="co">## [1] "class"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $anova$pAdjust</span></span>
<span><span class="co">## [1] "bonferroni"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $anova$comparisons</span></span>
<span><span class="co">## list()</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $anova$returnModels</span></span>
<span><span class="co">## [1] FALSE</span></span></code></pre>
<p>Refer to the documentation (<code>?</code>) of each function for
sepecific usage details.</p>
<p>The parameters returned by these functions can be assigned to an
<code>AnalysisParameters</code> object, again using
<code><a href="../reference/parameters.html">parameters()</a></code>’</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/parameters.html">parameters</a></span><span class="op">(</span><span class="va">p</span>,<span class="st">'pre-treatment'</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pre-treatment-parameters.html">preTreatmentParameters</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    occupancyFilter <span class="op">=</span> <span class="st">'maximum'</span>,</span>
<span>    transform <span class="op">=</span> <span class="st">'TICnorm'</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="yaml-specification">YAML specification<a class="anchor" aria-label="anchor" href="#yaml-specification"></a>
</h4>
<p>Due to the relatively complex structure of the parameters needed for
analyses containing many components, it is also possible to specify
analysis parameters using the YAML file format. YAML parameter files
(.yaml) can be parsed using the <code><a href="../reference/io-parameters.html">parseParameters()</a></code> function.
The example below shows the YAML specification for the defaults returned
by <code><a href="../reference/analysisParameters.html">analysisParameters()</a></code>.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pre-treatment</span><span class="kw">:</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">QC</span><span class="kw">:</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">occupancyFilter</span><span class="kw">:</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">cls</span><span class="kw">:</span><span class="at"> class</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">QCidx</span><span class="kw">:</span><span class="at"> QC</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">occupancy</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.6666667</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">impute</span><span class="kw">:</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">cls</span><span class="kw">:</span><span class="at"> class</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">QCidx</span><span class="kw">:</span><span class="at"> QC</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">occupancy</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.6666667</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">parallel</span><span class="kw">:</span><span class="at"> variables</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">seed</span><span class="kw">:</span><span class="at"> </span><span class="fl">1234.0</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">RSDfilter</span><span class="kw">:</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">cls</span><span class="kw">:</span><span class="at"> class</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">QCidx</span><span class="kw">:</span><span class="at"> QC</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">RSDthresh</span><span class="kw">:</span><span class="at"> </span><span class="fl">50.0</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">removeQC</span><span class="kw">:</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">cls</span><span class="kw">:</span><span class="at"> class</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">QCidx</span><span class="kw">:</span><span class="at"> QC</span></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">occupancyFilter</span><span class="kw">:</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">maximum</span><span class="kw">:</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">cls</span><span class="kw">:</span><span class="at"> class</span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">occupancy</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.6666667</span></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">impute</span><span class="kw">:</span></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">class</span><span class="kw">:</span></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">cls</span><span class="kw">:</span><span class="at"> class</span></span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">occupancy</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.6666667</span></span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">seed</span><span class="kw">:</span><span class="at"> </span><span class="fl">1234.0</span></span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">transform</span><span class="kw">:</span></span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">TICnorm</span><span class="kw">:</span><span class="at"> </span><span class="kw">{}</span></span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a><span class="fu">modelling</span><span class="kw">:</span></span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">randomForest</span><span class="kw">:</span></span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">cls</span><span class="kw">:</span><span class="at"> class</span></span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">rf</span><span class="kw">:</span><span class="at"> </span><span class="kw">[]</span></span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">reps</span><span class="kw">:</span><span class="at"> </span><span class="fl">1.0</span></span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">binary</span><span class="kw">:</span><span class="at"> </span><span class="ch">no</span></span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">comparisons</span><span class="kw">:</span><span class="at"> </span><span class="kw">[]</span></span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">perm</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.0</span></span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">returnModels</span><span class="kw">:</span><span class="at"> </span><span class="ch">no</span></span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">seed</span><span class="kw">:</span><span class="at"> </span><span class="fl">1234.0</span></span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a><span class="fu">correlations</span><span class="kw">:</span></span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">method</span><span class="kw">:</span><span class="at"> pearson</span></span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">pAdjustMethod</span><span class="kw">:</span><span class="at"> bonferroni</span></span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">corPvalue</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.05</span></span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">minCoef</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.0</span></span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">maxCor</span><span class="kw">:</span><span class="at"> </span><span class="fl">.inf</span></span></code></pre></div>
<p>This can be passed directly into an <code>AnalysisParameters</code>
object using the following:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paramFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'defaultParameters.yaml'</span>,package <span class="op">=</span> <span class="st">'metabolyseR'</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/io-parameters.html">parseParameters</a></span><span class="op">(</span><span class="va">paramFile</span><span class="op">)</span></span></code></pre></div>
<p>For more complex pre-treatment situations such as the following:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pre-treatment</span><span class="kw">:</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">remove</span><span class="kw">:</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">sample</span><span class="kw">:</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">idx</span><span class="kw">:</span><span class="at"> fileOrder</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">samples</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">remove1</span><span class="kw">:</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">class</span><span class="kw">:</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">cls</span><span class="kw">:</span><span class="at"> day</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">classes</span><span class="kw">:</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> H</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">occupancyFilter</span><span class="kw">:</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">maximum</span><span class="kw">:</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">cls</span><span class="kw">:</span><span class="at"> class</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">occupancy</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.667</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">transform</span><span class="kw">:</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">TICnorm</span><span class="kw">:</span><span class="at"> </span><span class="ch">~</span></span></code></pre></div>
<p>Where multiple steps of the same method needed (here is
<code>remove</code>), these are numbered sequentially. Where multiple
values also need to be provided to a particular argument
(e.g. <code>classes = c('H','1')</code>), these should be supplied as a
hyphenated list.</p>
<p>Existing <code>AnalysisParameters</code> objects can also be exported
to YAML format as shown below:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analysisParameters.html">analysisParameters</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/io-parameters.html">exportParameters</a></span><span class="op">(</span><span class="va">p</span>,file <span class="op">=</span> <span class="st">'analysis_parameters.yaml'</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="performing-an-analysis">Performing an analysis<a class="anchor" aria-label="anchor" href="#performing-an-analysis"></a>
</h3>
<p>The analysis is performed in a single step using the
<code><a href="../reference/metabolyse.html">metabolyse()</a></code> function. This accepts the metabolomic data,
the sample information and the analysis parameters.</p>
<p>The metabolomic data table of abundance values where the columns are
the metabolome features and the rows are each sample observation.
Similarly, the sample meta-information table should consist of the
observations as rows and the meta information as columns. <strong>The
order of the observation rows of the sample information table should be
concordant with the rows in the metabolomics data table.</strong></p>
<p>We can run an example analysis using the <code>abr1</code> data set
by first generating the default parameters for pre-treatment and
modelling (random forest) analysis elements.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analysisParameters.html">analysisParameters</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'pre-treatment'</span>,<span class="st">'modelling'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Custom pre-treatment parameters can then be specified to only inlude
occupancy filtering and total ion count normalisation.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/parameters.html">parameters</a></span><span class="op">(</span><span class="va">p</span>,<span class="st">'pre-treatment'</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pre-treatment-parameters.html">preTreatmentParameters</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  occupancyFilter <span class="op">=</span> <span class="st">'maximum'</span>,</span>
<span>  transform <span class="op">=</span> <span class="st">'TICnorm'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Next the <code>cls</code> parameters can be changed to use the
<code>day</code> sample information column throughout the analysis.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">changeParameter</span><span class="op">(</span><span class="va">p</span>,<span class="st">'cls'</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">'day'</span></span></code></pre></div>
<p>Finally, the analysis can be run in a single step. Here only the fist
200 features of the negative ionisation mode data are specified to
reduce the analysis time needed for this example.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/metabolyse.html">metabolyse</a></span><span class="op">(</span><span class="va">abr1</span><span class="op">$</span><span class="va">neg</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">]</span>,<span class="va">abr1</span><span class="op">$</span><span class="va">fact</span>,<span class="va">p</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co"><span style="color: #0000BB;">## metabolyseR </span> <span style="color: #BB0000;">v0.15.1</span> Tue May 30 14:35:07 2023</span></span></code></pre>
<pre><code><span><span class="co">## ________________________________________________________________________________</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #BBBB00;">Parameters:</span></span></span>
<span><span class="co">## pre-treatment</span></span>
<span><span class="co">##  occupancyFilter</span></span>
<span><span class="co">##      maximum</span></span>
<span><span class="co">##          cls = day</span></span>
<span><span class="co">##          occupancy = 2/3</span></span>
<span><span class="co">##  transform</span></span>
<span><span class="co">##      TICnorm</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## modelling</span></span>
<span><span class="co">##  randomForest</span></span>
<span><span class="co">##      cls = day</span></span>
<span><span class="co">##      rf = list()</span></span>
<span><span class="co">##      reps = 1</span></span>
<span><span class="co">##      binary = FALSE</span></span>
<span><span class="co">##      comparisons = list()</span></span>
<span><span class="co">##      perm = 0</span></span>
<span><span class="co">##      returnModels = FALSE</span></span>
<span><span class="co">##      seed = 1234</span></span></code></pre>
<pre><code><span><span class="co">## ________________________________________________________________________________</span></span></code></pre>
<pre><code>##  [34mPre-treatment  [39m…

 [34mPre-treatment  [39m     [32m✔ [39m [0.6S]
##  [34mModelling  [39m…
 [34m
Modelling  [39m  [32m✔ [39m [2.1S]
## ________________________________________________________________________________
## 
##  [32mComplete!  [39m[2.7S]</code></pre>
<p><strong>Note: If a data pre-treatment step is not performed prior to
modelling or correlation analysis, the raw data will automatically be
used.</strong></p>
<p>The <code>analysis</code> object containing the analysis results can
be printed to provide some basic information about the results of the
analysis.</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">analysis</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #0000BB;">metabolyseR </span><span style="color: #BB0000; font-weight: bold;">v0.15.1</span></span></span>
<span><span class="co"><span style="color: #BBBB00;">## Analysis:</span></span></span>
<span><span class="co"><span style="color: #BBBB00;">## </span>    Tue May 30 14:35:07 2023</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Raw Data:</span></span>
<span><span class="co">##      No. samples = 120</span></span>
<span><span class="co">##      No. features = 200</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Pre-treated Data:</span></span>
<span><span class="co">##      Tue May 30 14:35:07 2023</span></span>
<span><span class="co">##      No. samples = 120</span></span>
<span><span class="co">##      No. features = 48</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Modelling:</span></span>
<span><span class="co">##      Tue May 30 14:35:09 2023</span></span>
<span><span class="co">##      Methods: randomForest</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="performing-a-re-analysis">Performing a re-analysis<a class="anchor" aria-label="anchor" href="#performing-a-re-analysis"></a>
</h3>
<p>There are likely to be occasions where an analysis will need to be
re-analysed using a new set of parameters. This can be achieved using
the <code><a href="../reference/metabolyse.html">reAnalyse()</a></code> function.</p>
<p>In the example below we will run a correlation analysis in addition
to the pre-treatment and modelling elements already performed.</p>
<p>Firstly, we can specify the correlation parameters:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analysisParameters.html">analysisParameters</a></span><span class="op">(</span><span class="st">'correlations'</span><span class="op">)</span></span></code></pre></div>
<p>Then perform the re-analysis on our previously analysed
<code>Analysis</code> object, specifying the additional parameters.</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/metabolyse.html">reAnalyse</a></span><span class="op">(</span><span class="va">analysis</span>,<span class="va">parameters</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #0000BB;">metabolyseR</span> <span style="color: #BB0000;">v0.15.1</span> Tue May 30 14:35:10 2023</span></span>
<span><span class="co">## ________________________________________________________________________________</span></span>
<span><span class="co">## <span style="color: #BBBB00;">Parameters:</span></span></span>
<span><span class="co">## correlations</span></span>
<span><span class="co">##  method = pearson</span></span>
<span><span class="co">##  pAdjustMethod = bonferroni</span></span>
<span><span class="co">##  corPvalue = 0.05</span></span>
<span><span class="co">##  minCoef = 0</span></span>
<span><span class="co">##  maxCor = Inf</span></span>
<span><span class="co">## ________________________________________________________________________________</span></span></code></pre>
<pre><code>##  [34mCorrelations  [39m…
 [34m
Correlations  [39m   [32m✔ [39m [0.1S]</code></pre>
<pre><code><span><span class="co">## ________________________________________________________________________________</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BB00;">Complete! </span>[0.1S]</span></span></code></pre>
<p>An overview of the results of the analysis (now including
correlations) can then be printed.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">analysis</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #0000BB;">metabolyseR </span><span style="color: #BB0000; font-weight: bold;">v0.15.1</span></span></span>
<span><span class="co"><span style="color: #BBBB00;">## Analysis:</span></span></span>
<span><span class="co"><span style="color: #BBBB00;">## </span>    Tue May 30 14:35:07 2023</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Raw Data:</span></span>
<span><span class="co">##      No. samples = 120</span></span>
<span><span class="co">##      No. features = 200</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Pre-treated Data:</span></span>
<span><span class="co">##      Tue May 30 14:35:07 2023</span></span>
<span><span class="co">##      No. samples = 120</span></span>
<span><span class="co">##      No. features = 48</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Modelling:</span></span>
<span><span class="co">##      Tue May 30 14:35:09 2023</span></span>
<span><span class="co">##      Methods: randomForest</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Correlations:</span></span>
<span><span class="co">##      Tue May 30 14:35:10 2023</span></span>
<span><span class="co">##      No. correlations = 140</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="extracting-analysis-results">Extracting analysis results<a class="anchor" aria-label="anchor" href="#extracting-analysis-results"></a>
</h3>
<p>An analysis performed by <code><a href="../reference/metabolyse.html">metabolyse()</a></code> returns an S4
object of class <code>Analysis</code>. There are a number of ways of
extracting analysis results from this object.</p>
<p>Similarly to the <code>AnalysisData</code> class, the
<code><a href="../reference/analysis-accessors.html">dat()</a></code> and <code><a href="../reference/analysis-accessors.html">sinfo()</a></code> functions can be used to
extract the metabolomics data or sample information tables directly for
either the <code>raw</code> or <code>pre-treated</code> data.</p>
<p>For example, to extract the pre-treated metabolomics data from our
object <code>analysis</code>:</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/analysis-accessors.html">dat</a></span><span class="op">(</span><span class="va">analysis</span>,type <span class="op">=</span> <span class="st">'pre-treated'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 120 × 48</span></span></span>
<span><span class="co">##       N113    N115    N117    N118    N119    N127    N128    N129  N130    N131</span></span>
<span><span class="co">##      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> 0.006<span style="text-decoration: underline;">46</span> 0   <span style="color: #949494;"> </span>   1.68<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 0   <span style="color: #949494;"> </span>   1.60<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 0.032<span style="text-decoration: underline;">3</span>  2.65<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 2.80<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>     0 0   <span style="color: #949494;"> </span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> 0.011<span style="text-decoration: underline;">3</span>  7.74<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 1.02<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 0   <span style="color: #949494;"> </span>   1.43<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 0.008<span style="text-decoration: underline;">56</span> 0   <span style="color: #949494;"> </span>   3.95<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>     0 0   <span style="color: #949494;"> </span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> 0.009<span style="text-decoration: underline;">31</span> 6.01<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 2.70<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 6.22<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 5.58<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 0       0   <span style="color: #949494;"> </span>   1.05<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>     0 6.51<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> 0.007<span style="text-decoration: underline;">98</span> 0   <span style="color: #949494;"> </span>   0   <span style="color: #949494;"> </span>   0   <span style="color: #949494;"> </span>   1.62<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 0.008<span style="text-decoration: underline;">48</span> 0   <span style="color: #949494;"> </span>   4.05<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>     0 1.28<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> 0.010<span style="text-decoration: underline;">5</span>  0   <span style="color: #949494;"> </span>   0   <span style="color: #949494;"> </span>   0   <span style="color: #949494;"> </span>   0   <span style="color: #949494;"> </span>   0.006<span style="text-decoration: underline;">58</span> 0   <span style="color: #949494;"> </span>   1.97<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span>     0 0   <span style="color: #949494;"> </span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> 0.004<span style="text-decoration: underline;">54</span> 0   <span style="color: #949494;"> </span>   2.48<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 3.25<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 5.31<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 0.002<span style="text-decoration: underline;">07</span> 0   <span style="color: #949494;"> </span>   1.98<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>     0 0   <span style="color: #949494;"> </span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> 0.011<span style="text-decoration: underline;">7</span>  0   <span style="color: #949494;"> </span>   1.14<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 0   <span style="color: #949494;"> </span>   4.39<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 0.006<span style="text-decoration: underline;">03</span> 0   <span style="color: #949494;"> </span>   4.04<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>     0 0   <span style="color: #949494;"> </span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> 0.007<span style="text-decoration: underline;">87</span> 2.36<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 1.43<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 1.52<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 4.22<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 0.002<span style="text-decoration: underline;">90</span> 2.78<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 5.76<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>     0 0   <span style="color: #949494;"> </span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> 0.001<span style="text-decoration: underline;">36</span> 1.87<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 8.17<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 1.87<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 0   <span style="color: #949494;"> </span>   0.061<span style="text-decoration: underline;">0</span>  1.31<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 5.23<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>     0 0   <span style="color: #949494;"> </span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> 0.008<span style="text-decoration: underline;">99</span> 4.26<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 2.06<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 0   <span style="color: #949494;"> </span>   8.36<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 0.001<span style="text-decoration: underline;">06</span> 7.72<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 0   <span style="color: #949494;"> </span>       0 0   <span style="color: #949494;"> </span>  </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 110 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 38 more variables: N132 &lt;dbl&gt;, N133 &lt;dbl&gt;, N134 &lt;dbl&gt;, N135 &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   N136 &lt;dbl&gt;, N137 &lt;dbl&gt;, N139 &lt;dbl&gt;, N143 &lt;dbl&gt;, N145 &lt;dbl&gt;, N146 &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   N147 &lt;dbl&gt;, N149 &lt;dbl&gt;, N153 &lt;dbl&gt;, N155 &lt;dbl&gt;, N157 &lt;dbl&gt;, N161 &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   N163 &lt;dbl&gt;, N164 &lt;dbl&gt;, N165 &lt;dbl&gt;, N168 &lt;dbl&gt;, N169 &lt;dbl&gt;, N170 &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   N171 &lt;dbl&gt;, N173 &lt;dbl&gt;, N174 &lt;dbl&gt;, N175 &lt;dbl&gt;, N179 &lt;dbl&gt;, N180 &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   N181 &lt;dbl&gt;, N183 &lt;dbl&gt;, N187 &lt;dbl&gt;, N191 &lt;dbl&gt;, N192 &lt;dbl&gt;, N193 &lt;dbl&gt;, …</span></span></span></code></pre>
<p>Or to extract the raw sample information:</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/analysis-accessors.html">sinfo</a></span><span class="op">(</span><span class="va">analysis</span>,type <span class="op">=</span> <span class="st">'raw'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 120 × 9</span></span></span>
<span><span class="co">##    injorder pathcdf              filecdf name.org remark name    rep day   class</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>        1 C:/Xcalibur/ANDI-LT… 01.cdf  12_2     ok     12_2      2 2         2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>        2 C:/Xcalibur/ANDI-LT… 02.cdf  13_3     ok     13_4      3 3         3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>        3 C:/Xcalibur/ANDI-LT… 03.cdf  15_4     ok     15_5      5 4         4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>        4 C:/Xcalibur/ANDI-LT… 04.cdf  12_1     ok     12_2      2 1         1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>        5 C:/Xcalibur/ANDI-LT… 05.cdf  12_2     ok     12_2      2 2         2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>        6 C:/Xcalibur/ANDI-LT… 06.cdf  11_1     ok     11_2      1 1         1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>        7 C:/Xcalibur/ANDI-LT… 07.cdf  14_2     ok     14_3      4 2         2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>        8 C:/Xcalibur/ANDI-LT… 08.cdf  11_4     ok     11_5      1 4         4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>        9 C:/Xcalibur/ANDI-LT… 09.cdf  13_H     ok     13_H      3 H         6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>       10 C:/Xcalibur/ANDI-LT… 10.cdf  15_H     ok     15_H      5 H         6</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 110 more rows</span></span></span></code></pre>
<p>Alternatively the <code>raw</code> or <code>preTreated</code>
functions can be used to extract the <code>AnalysisData</code> class
objects containing both the metabolomics data and sample information for
the raw and pre-treated data respectively.</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/analysis-accessors.html">raw</a></span><span class="op">(</span><span class="va">analysis</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## AnalysisData object containing:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Samples: 120 </span></span>
<span><span class="co">## Features: 200 </span></span>
<span><span class="co">## Info: 9</span></span></code></pre>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/analysis-accessors.html">preTreated</a></span><span class="op">(</span><span class="va">analysis</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## AnalysisData object containing:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Samples: 120 </span></span>
<span><span class="co">## Features: 48 </span></span>
<span><span class="co">## Info: 9</span></span></code></pre>
<p>Lastly the <code>analysisResults</code> function can be used to
extract the results of any of the analysis elements. The following will
extract the modelling results:</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/analysis-accessors.html">analysisResults</a></span><span class="op">(</span><span class="va">analysis</span>,element <span class="op">=</span> <span class="st">'modelling'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $randomForest</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random forest classification </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Samples:  120 </span></span>
<span><span class="co">## Features:     48 </span></span>
<span><span class="co">## Response:     day </span></span>
<span><span class="co">## # comparisons:    1</span></span></code></pre>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jasen Finch.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
