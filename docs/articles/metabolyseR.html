<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction â€¢ metabolyseR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction">
<meta property="og:description" content="metabolyseR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metabolyseR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.14.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/metabolyseR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/pre_treatment.html">Metabolomics data pre-treatment</a>
    </li>
    <li>
      <a href="../articles/modelling.html">Modelling and feature selection</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jasenfinch/metabolyseR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="metabolyseR_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction</h1>
            <h3 class="subtitle">metabolyseR v0.14.4</h3>
                        <h4 class="author">Jasen Finch</h4>
            
            <h4 class="date">07 November, 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jasenfinch/metabolyseR/blob/master/vignettes/metabolyseR.Rmd"><code>vignettes/metabolyseR.Rmd</code></a></small>
      <div class="hidden name"><code>metabolyseR.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The <em>metabolyseR</em> package provides a suite of methods that encompass three elements of metabolomics data analysis:</p>
<ul>
<li>data pre-treatment</li>
<li>modelling / data mining</li>
<li>correlation analyses</li>
</ul>
<p>The package also distinguishes between the flexibility and simplicity required for <strong>exploratory</strong> analyses compared to the convenience needed for more complex <strong>routine</strong> analyses. This is reflected in the underlying S4 object-oriented implementations and associated methods defined within the package. It should be noted that it is useful to understand the principles involved in using <em>metabolyseR</em> for exploratory analyses to aid in extracting and wrangling the results generated from routine analyses.</p>
<p>The following document will provide an introduction to the basic usage of the package and includes how to create and use the base classes that are the foundation of <em>metabolyseR</em>. This will be focused around the applications for both exploratory and routine analyses. For more detailed information on the individual analysis elements see their associated vignette using:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/browseVignettes.html">browseVignettes</a></span><span class="op">(</span><span class="st">'metabolyseR'</span><span class="op">)</span></code></pre></div>
<p>There is also an example quick start analysis vignette provided.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html">vignette</a></span><span class="op">(</span><span class="st">'quick_start'</span>,<span class="st">'metabolyseR'</span><span class="op">)</span></code></pre></div>
<p>Any issues, bugs or errors encountered while using the package should be reported <a href="https://github.com/jasenfinch/metabolyseR/issues">here</a>.</p>
<p>The examples shown here will use the <code>abr1</code> data set from the <a href="https://aberhrml.github.io/metaboData/">metaboData</a> package (<code><a href="https://aberHRML.github.io/metaboData//reference/abr1.html">?metaboData::abr1</a></code>). This is a nominal mass flow-injection mass spectrometry (FI-MS) fingerprinting data set from a plant-pathogen infection time course experiment. The examples will also include use of the pipe <code>%&gt;%</code> from the <a href="https://magrittr.tidyverse.org/">magrittr</a> package.</p>
<p>Firstly load the necessary packages:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://jasenfinch.github.io/metabolyseR">metabolyseR</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://aberhrml.github.io/metaboData/">metaboData</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="parallel-processing" class="section level2">
<h2 class="hasAnchor">
<a href="#parallel-processing" class="anchor"></a>Parallel processing</h2>
<p>The package supports parallel processing using the <a href="https://CRAN.R-project.org/package=future">future</a> package.</p>
<p>By default, processing by <code>metabolyseR</code> will be done sequentially. However, parallel processing can be activated, prior to analysis, by specifying a parallel back-end using <code><a href="https://future.futureverse.org/reference/plan.html">plan()</a></code>. The following example specifies using the <code>multisession</code> implementation (multiple background R sessions) with two worker processes.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="va"><a href="https://future.futureverse.org/reference/multisession.html">multisession</a></span>,workers <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p>See the future package <a href="https://CRAN.R-project.org/package=future">documentation</a> for more information on the types of parallel implementations that are available.</p>
</div>
<div id="exploratory-analyses" class="section level2">
<h2 class="hasAnchor">
<a href="#exploratory-analyses" class="anchor"></a>Exploratory analyses</h2>
<p>For exploratory analyses, simple questions of the data need to be answered quickly, requiring few steps. Key requirements for any tool used by investigators are that it should be both simple and flexible.</p>
<p>In <em>metabolyseR</em>, the <code>AnalysisData</code> class is the base S4 class that provides these requirements. The following sections will give an overview of the basics in constructing and using these objects as the base for analysis.</p>
<div id="analysis-data" class="section level3">
<h3 class="hasAnchor">
<a href="#analysis-data" class="anchor"></a>Analysis data</h3>
<p>We can firstly construct an <code>AnalysisData</code> object which requires two data tables. The first is the metabolomic data where the columns are the metabolome features, the rows the sample observations and contains the abundance values. The second is the sample meta-information where the row order should match to that of the metabolome data table. Using the example data, his can be constructed and assigned to the variable <code>d</code> by:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analysisData.html">analysisData</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">abr1</span><span class="op">$</span><span class="va">neg</span>,
                  info <span class="op">=</span> <span class="va">abr1</span><span class="op">$</span><span class="va">fact</span><span class="op">)</span></code></pre></div>
<p>Where <code>abr1$neg</code> is the negative ionisation mode data and <code>abr1$fact</code> is the corresponding sample information. By printing <code>d</code> we can view some basic information about our data.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## AnalysisData object containing:
## 
## Samples: 120 
## Features: 2000 
## Info: 9</code></pre>
<p>We can also return the numbers of samples and numbers of features respectively using the following:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/dat.html">nSamples</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 120</code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/dat.html">nFeatures</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 2000</code></pre>
<p>The data table can be extracted using the <code>dat</code> method:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/dat.html">dat</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 120 Ã— 2,000
##       N1    N2    N3    N4    N5    N6    N7    N8    N9   N10   N11   N12   N13
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     0     0     0     0     0     0     0     0     0     0     0     0     0
##  2     0     0     0     0     0     0     0     0     0     0     0     0     0
##  3     0     0     0     0     0     0     0     0     0     0     0     0     0
##  4     0     0     0     0     0     0     0     0     0     0     0     0     0
##  5     0     0     0     0     0     0     0     0     0     0     0     0     0
##  6     0     0     0     0     0     0     0     0     0     0     0     0     0
##  7     0     0     0     0     0     0     0     0     0     0     0     0     0
##  8     0     0     0     0     0     0     0     0     0     0     0     0     0
##  9     0     0     0     0     0     0     0     0     0     0     0     0     0
## 10     0     0     0     0     0     0     0     0     0     0     0     0     0
## # â€¦ with 110 more rows, and 1,987 more variables: N14 &lt;dbl&gt;, N15 &lt;dbl&gt;,
## #   N16 &lt;dbl&gt;, N17 &lt;dbl&gt;, N18 &lt;dbl&gt;, N19 &lt;dbl&gt;, N20 &lt;dbl&gt;, N21 &lt;dbl&gt;,
## #   N22 &lt;dbl&gt;, N23 &lt;dbl&gt;, N24 &lt;dbl&gt;, N25 &lt;dbl&gt;, N26 &lt;dbl&gt;, N27 &lt;dbl&gt;,
## #   N28 &lt;dbl&gt;, N29 &lt;dbl&gt;, N30 &lt;dbl&gt;, N31 &lt;dbl&gt;, N32 &lt;dbl&gt;, N33 &lt;dbl&gt;,
## #   N34 &lt;dbl&gt;, N35 &lt;dbl&gt;, N36 &lt;dbl&gt;, N37 &lt;dbl&gt;, N38 &lt;dbl&gt;, N39 &lt;dbl&gt;,
## #   N40 &lt;dbl&gt;, N41 &lt;dbl&gt;, N42 &lt;dbl&gt;, N43 &lt;dbl&gt;, N44 &lt;dbl&gt;, N45 &lt;dbl&gt;,
## #   N46 &lt;dbl&gt;, N47 &lt;dbl&gt;, N48 &lt;dbl&gt;, N49 &lt;dbl&gt;, N50 &lt;dbl&gt;, N51 &lt;dbl&gt;, â€¦</code></pre>
<p>Or alternatively, can be used to assign a new data table:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/dat.html">dat</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">abr1</span><span class="op">$</span><span class="va">pos</span>
<span class="va">d</span></code></pre></div>
<pre><code>## 
## AnalysisData object containing:
## 
## Samples: 120 
## Features: 2000 
## Info: 9</code></pre>
<p>The sample information table can be extracted using the <code>sinfo</code> method:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/dat.html">sinfo</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 120 Ã— 9
##    injorder pathcdf              filecdf name.org remark name    rep day   class
##       &lt;int&gt; &lt;fct&gt;                &lt;fct&gt;   &lt;fct&gt;    &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;fct&gt; &lt;int&gt;
##  1        1 C:/Xcalibur/ANDI-LTâ€¦ 01.cdf  12_2     ok     12_2      2 2         2
##  2        2 C:/Xcalibur/ANDI-LTâ€¦ 02.cdf  13_3     ok     13_4      3 3         3
##  3        3 C:/Xcalibur/ANDI-LTâ€¦ 03.cdf  15_4     ok     15_5      5 4         4
##  4        4 C:/Xcalibur/ANDI-LTâ€¦ 04.cdf  12_1     ok     12_2      2 1         1
##  5        5 C:/Xcalibur/ANDI-LTâ€¦ 05.cdf  12_2     ok     12_2      2 2         2
##  6        6 C:/Xcalibur/ANDI-LTâ€¦ 06.cdf  11_1     ok     11_2      1 1         1
##  7        7 C:/Xcalibur/ANDI-LTâ€¦ 07.cdf  14_2     ok     14_3      4 2         2
##  8        8 C:/Xcalibur/ANDI-LTâ€¦ 08.cdf  11_4     ok     11_5      1 4         4
##  9        9 C:/Xcalibur/ANDI-LTâ€¦ 09.cdf  13_H     ok     13_H      3 H         6
## 10       10 C:/Xcalibur/ANDI-LTâ€¦ 10.cdf  15_H     ok     15_H      5 H         6
## # â€¦ with 110 more rows</code></pre>
<p>And similarly used to assign a new sample information table:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/dat.html">sinfo</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">abr1</span><span class="op">$</span><span class="va">fact</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>
<span class="va">d</span></code></pre></div>
<pre><code>## 
## AnalysisData object containing:
## 
## Samples: 120 
## Features: 2000 
## Info: 2</code></pre>
</div>
<div id="sample-information" class="section level3">
<h3 class="hasAnchor">
<a href="#sample-information" class="anchor"></a>Sample information</h3>
<p>There are a number of methods that provide utility for querying and altering the sample information within an <code>AnalysisData</code> object. These methods are all named with the prefix <code>cls</code> and include:</p>
<ul>
<li><code>clsAdd</code></li>
<li><code>clsArrange</code></li>
<li><code>clsAvailable</code></li>
<li><code>clsExtract</code></li>
<li><code>clsRemove</code></li>
<li><code>clsRename</code></li>
<li><code>clsReplace</code></li>
</ul>
<p>The names of the available sample information columns can be shown using <code><a href="../reference/clsAdd.html">clsAvailable()</a></code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/clsAdd.html">clsAvailable</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "injorder" "pathcdf"  "filecdf"  "name.org" "remark"   "name"     "rep"     
## [8] "day"      "class"</code></pre>
<p>A given column can be extracted using <code><a href="../reference/clsAdd.html">clsExtract()</a></code>. Here, the <code>day</code> column is extracted.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/clsAdd.html">clsExtract</a></span><span class="op">(</span><span class="va">d</span>,cls <span class="op">=</span> <span class="st">'day'</span><span class="op">)</span></code></pre></div>
<pre><code>##   [1] 2 3 4 1 2 1 2 4 H H 4 5 1 2 H 5 3 3 2 H 4 3 5 4 H H 3 H H 1 1 1 5 5 3 4 H
##  [38] 1 5 5 1 2 4 3 2 4 3 2 5 4 4 H 3 4 2 4 4 1 5 4 4 1 1 H 3 2 H 3 3 1 2 H H 2
##  [75] 3 5 3 2 5 2 4 3 H 2 3 2 1 1 4 5 3 2 1 H 5 2 4 H 1 4 4 1 1 5 H 5 1 3 3 5 5
## [112] 5 3 2 5 H 5 H 2 1
## Levels: 1 2 3 4 5 H</code></pre>
<p>Sample class frequencies could then be computed.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/clsAdd.html">clsExtract</a></span><span class="op">(</span><span class="va">d</span>,cls <span class="op">=</span> <span class="st">'day'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## .
##  1  2  3  4  5  H 
## 20 20 20 20 20 20</code></pre>
<p>It can be seen that there are 20 samples available in each class.</p>
<p>Another example is the addition of a new sample information column. In the following, a column called <code>new_class</code> will be added with all samples labelled <code>1</code>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clsAdd.html">clsAdd</a></span><span class="op">(</span><span class="va">d</span>,cls <span class="op">=</span> <span class="st">'new_class'</span>,value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="../reference/dat.html">nSamples</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/clsAdd.html">clsAvailable</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "injorder"  "pathcdf"   "filecdf"   "name.org"  "remark"    "name"     
##  [7] "rep"       "day"       "class"     "new_class"</code></pre>
</div>
<div id="keeping-removing-samples-or-features" class="section level3">
<h3 class="hasAnchor">
<a href="#keeping-removing-samples-or-features" class="anchor"></a>Keeping / removing samples or features</h3>
<p>Samples or features can easily be kept or removed from an <code>AnalysisData</code> object as is most convenient.</p>
<p>Below can be seen the first 6 sample indexes in the <code>injorder</code> column of the sample information.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">samples</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/clsAdd.html">clsExtract</a></span><span class="op">(</span>cls <span class="op">=</span> <span class="st">'injorder'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1 2 3 4 5 6</code></pre>
<p>Only these samples could be kept using:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/keepClasses.html">keepSamples</a></span><span class="op">(</span>idx <span class="op">=</span> <span class="st">'injorder'</span>,samples <span class="op">=</span> <span class="va">samples</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## AnalysisData object containing:
## 
## Samples: 6 
## Features: 2000 
## Info: 10</code></pre>
<p>Or removed using:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/removeClasses.html">removeSamples</a></span><span class="op">(</span>idx <span class="op">=</span> <span class="st">'injorder'</span>,samples <span class="op">=</span> <span class="va">samples</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## AnalysisData object containing:
## 
## Samples: 114 
## Features: 2000 
## Info: 10</code></pre>
<p>The process is very similar for keeping or removing specific metabolome features from the data table. Below can be seen the first 6 feature names in the data table.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">feat</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/dat.html">features</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">feat</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "N1" "N2" "N3" "N4" "N5" "N6"</code></pre>
<p>Only these features can be kept using:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/keepClasses.html">keepFeatures</a></span><span class="op">(</span>features <span class="op">=</span> <span class="va">feat</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## AnalysisData object containing:
## 
## Samples: 120 
## Features: 6 
## Info: 10</code></pre>
<p>Or to remove these features:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/removeClasses.html">removeFeatures</a></span><span class="op">(</span>features <span class="op">=</span> <span class="va">feat</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## AnalysisData object containing:
## 
## Samples: 120 
## Features: 1994 
## Info: 10</code></pre>
</div>
</div>
<div id="routine-analyses" class="section level2">
<h2 class="hasAnchor">
<a href="#routine-analyses" class="anchor"></a>Routine analyses</h2>
<p>Routine analyses are those that are often made up of numerous steps where parameters have likely already been previously established. The emphasis here is on convenience with as little code as possible required. In these analyses, the necessary analysis elements, order and parameters are first prepared and then the analysis routine subsequently performed in a single step. This section will introduce how this type of analysis can be performed using <em>metabolyseR</em> and will include four main topics:</p>
<ul>
<li>analysis parameter selection</li>
<li>performing an analysis</li>
<li>performing a re-analysis</li>
<li>extracting analysis results</li>
</ul>
<div id="analysis-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#analysis-parameters" class="anchor"></a>Analysis parameters</h3>
<p>Parameter selection is the fundamental aspect for performing routine analyses using <em>metabolyseR</em> and will be the step requiring the most input from the user. The parameters for an analysis are stored in an S4 object of class <code>AnalysisParameters</code> containing the relevant parameters of the selected analysis elements.</p>
<p>The parameters have been named so that they denote the same functionality commonly across all analysis element methods. <strong>Discussion of the specific parameters can be found withing the vignettes of the relevant analysis elements.</strong> These can be accessed using:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/browseVignettes.html">browseVignettes</a></span><span class="op">(</span><span class="st">'metabolyseR'</span><span class="op">)</span></code></pre></div>
<p>There are several ways to specify the parameters to use for analysis. The first is programatically and the second is through the use of the YAML format.</p>
<div id="programatic-specification" class="section level4">
<h4 class="hasAnchor">
<a href="#programatic-specification" class="anchor"></a>Programatic specification</h4>
<p>The available analysis elements can be shown using:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/analysisElements.html">analysisElements</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "pre-treatment" "modelling"     "correlations"</code></pre>
<p>The <code><a href="../reference/analysisParameters.html">analysisParameters()</a></code> function can be used to create an <code>AnalysisParameters</code> object containing the default parameters. For example, the code below will return default parameters for all the <em>metabolyseR</em> analysis elements.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analysisParameters.html">analysisParameters</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">p</span></code></pre></div>
<pre><code>## Parameters:
## pre-treatment
##  QC
##      occupancyFilter
##          cls = class
##          QCidx = QC
##          occupancy = 2/3
##      impute
##          cls = class
##          QCidx = QC
##          occupancy = 2/3
##          parallel = variables
##          seed = 1234
##      RSDfilter
##          cls = class
##          QCidx = QC
##          RSDthresh = 50
##      removeQC
##          cls = class
##          QCidx = QC
##  occupancyFilter
##      maximum
##          cls = class
##          occupancy = 2/3
##  impute
##      class
##          cls = class
##          occupancy = 2/3
##          seed = 1234
##  transform
##      TICnorm
## 
## modelling
##  randomForest
##      cls = class
##      rf = list()
##      reps = 1
##      binary = FALSE
##      comparisons = list()
##      perm = 0
##      returnModels = FALSE
##      seed = 1234
## 
## correlations
##  method = pearson
##  pAdjustMethod = bonferroni
##  corPvalue = 0.05</code></pre>
<p>To retrieve parameters for a subset of analysis elements the following can be run, returning parameters for only the pre-treatment and modelling elements.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analysisParameters.html">analysisParameters</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'pre-treatment'</span>,<span class="st">'modelling'</span><span class="op">)</span><span class="op">)</span>
<span class="va">p</span></code></pre></div>
<pre><code>## Parameters:
## pre-treatment
##  QC
##      occupancyFilter
##          cls = class
##          QCidx = QC
##          occupancy = 2/3
##      impute
##          cls = class
##          QCidx = QC
##          occupancy = 2/3
##          parallel = variables
##          seed = 1234
##      RSDfilter
##          cls = class
##          QCidx = QC
##          RSDthresh = 50
##      removeQC
##          cls = class
##          QCidx = QC
##  occupancyFilter
##      maximum
##          cls = class
##          occupancy = 2/3
##  impute
##      class
##          cls = class
##          occupancy = 2/3
##          seed = 1234
##  transform
##      TICnorm
## 
## modelling
##  randomForest
##      cls = class
##      rf = list()
##      reps = 1
##      binary = FALSE
##      comparisons = list()
##      perm = 0
##      returnModels = FALSE
##      seed = 1234</code></pre>
<p>The <code>changeParameter()</code> function can be used to uniformly change these parameters across all of the selected methods. The example below changes the defaults of all the parameters named <code>cls</code> from the default <code>class</code> to <code>day</code>.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analysisParameters.html">analysisParameters</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu">changeParameter</span><span class="op">(</span><span class="va">p</span>,<span class="st">'cls'</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">'day'</span>
<span class="va">p</span></code></pre></div>
<pre><code>## Parameters:
## pre-treatment
##  QC
##      occupancyFilter
##          cls = day
##          QCidx = QC
##          occupancy = 2/3
##      impute
##          cls = day
##          QCidx = QC
##          occupancy = 2/3
##          parallel = variables
##          seed = 1234
##      RSDfilter
##          cls = day
##          QCidx = QC
##          RSDthresh = 50
##      removeQC
##          cls = day
##          QCidx = QC
##  occupancyFilter
##      maximum
##          cls = day
##          occupancy = 2/3
##  impute
##      class
##          cls = day
##          occupancy = 2/3
##          seed = 1234
##  transform
##      TICnorm
## 
## modelling
##  randomForest
##      cls = day
##      rf = list()
##      reps = 1
##      binary = FALSE
##      comparisons = list()
##      perm = 0
##      returnModels = FALSE
##      seed = 1234
## 
## correlations
##  method = pearson
##  pAdjustMethod = bonferroni
##  corPvalue = 0.05</code></pre>
<p>Alternatively the parameters of a specific analysis elements can be targeted using the <code>elements</code> argument. The following will only alter the <code>cls</code> parameter back to <code>class</code> for the pre-treatment element parameters:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">changeParameter</span><span class="op">(</span><span class="va">p</span>,<span class="st">'cls'</span>,elements <span class="op">=</span> <span class="st">'pre-treatment'</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">'class'</span></code></pre></div>
<p>Parameters can be extracted from the <code>AnalysisParameters</code> class using the <code><a href="../reference/parameters.html">parameters()</a></code> function for a specified element.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/parameters.html">parameters</a></span><span class="op">(</span><span class="va">p</span>,<span class="st">'correlations'</span><span class="op">)</span></code></pre></div>
<pre><code>## $method
## [1] "pearson"
## 
## $pAdjustMethod
## [1] "bonferroni"
## 
## $corPvalue
## [1] 0.05</code></pre>
<p>Each analysis element has a function for returning default parameters for specific methods. These include <code><a href="../reference/preTreatmentElements.html">preTreatmentParameters()</a></code>, <code><a href="../reference/modellingMethods.html">modellingParameters()</a></code> and <code>correlationParameters()</code>. Each returns a list of the default parameters for a specified methods as shown in the example for <code><a href="../reference/modellingMethods.html">modellingParameters()</a></code> below.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/modellingMethods.html">modellingParameters</a></span><span class="op">(</span><span class="st">'anova'</span><span class="op">)</span></code></pre></div>
<pre><code>## $anova
## $anova$cls
## [1] "class"
## 
## $anova$pAdjust
## [1] "bonferroni"
## 
## $anova$comparisons
## list()
## 
## $anova$returnModels
## [1] FALSE</code></pre>
<p>Refer to the documentation (<code>?</code>) of each function for sepecific usage details.</p>
<p>The parameters returned by these functions can be assigned to an <code>AnalysisParameters</code> object, again using <code><a href="../reference/parameters.html">parameters()</a></code>â€™</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/parameters.html">parameters</a></span><span class="op">(</span><span class="va">p</span>,<span class="st">'pre-treatment'</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/preTreatmentElements.html">preTreatmentParameters</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    occupancyFilter <span class="op">=</span> <span class="st">'maximum'</span>,
    transform <span class="op">=</span> <span class="st">'TICnorm'</span>
      <span class="op">)</span>
  <span class="op">)</span></code></pre></div>
</div>
<div id="yaml-specification" class="section level4">
<h4 class="hasAnchor">
<a href="#yaml-specification" class="anchor"></a>YAML specification</h4>
<p>Due to the relatively complex structure of the parameters needed for analyses containing many components, it is also possible to specify analysis parameters using the YAML file format. YAML parameter files (.yaml) can be parsed using the <code><a href="../reference/parseParameters.html">parseParameters()</a></code> function. The example below shows the YAML specification for the defaults returned by <code><a href="../reference/analysisParameters.html">analysisParameters()</a></code>.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pre-treatment</span><span class="kw">:</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">QC</span><span class="kw">:</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">occupancyFilter</span><span class="kw">:</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">cls</span><span class="kw">:</span><span class="at"> class</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">QCidx</span><span class="kw">:</span><span class="at"> QC</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">occupancy</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.667</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">impute</span><span class="kw">:</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">cls</span><span class="kw">:</span><span class="at"> class</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">QCidx</span><span class="kw">:</span><span class="at"> QC</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">occupancy</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.667</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">RSDfilter</span><span class="kw">:</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">cls</span><span class="kw">:</span><span class="at"> class</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">QCidx</span><span class="kw">:</span><span class="at"> QC</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">RSDthresh</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.5</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">removeQC</span><span class="kw">:</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">cls</span><span class="kw">:</span><span class="at"> class</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">QCidx</span><span class="kw">:</span><span class="at"> QC</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">occupancyFilter</span><span class="kw">:</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">maximum</span><span class="kw">:</span></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">cls</span><span class="kw">:</span><span class="at"> class</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">occupancy</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.667</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">impute</span><span class="kw">:</span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">class</span><span class="kw">:</span></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">cls</span><span class="kw">:</span><span class="at"> class</span></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">occupancy</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.667</span></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">nCores</span><span class="kw">:</span><span class="at"> </span><span class="dv">4</span></span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">clusterType</span><span class="kw">:</span><span class="at"> FORK</span></span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">transform</span><span class="kw">:</span></span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">TICnorm</span><span class="kw">:</span><span class="at"> </span><span class="ch">~</span></span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a><span class="fu">classification</span><span class="kw">:</span></span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">cls</span><span class="kw">:</span><span class="at"> class</span></span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">method</span><span class="kw">:</span><span class="at"> randomForest</span></span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">pars</span><span class="kw">:</span></span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">sampling</span><span class="kw">:</span><span class="at"> boot</span></span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">niter</span><span class="kw">:</span><span class="at"> </span><span class="dv">10</span></span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">nreps</span><span class="kw">:</span><span class="at"> </span><span class="dv">10</span></span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">strat</span><span class="kw">:</span><span class="at"> </span><span class="ch">yes</span></span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">nCores</span><span class="kw">:</span><span class="at"> </span><span class="dv">4</span></span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">clusterType</span><span class="kw">:</span><span class="at"> Fork</span></span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a><span class="fu">featureSelection</span><span class="kw">:</span></span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">method</span><span class="kw">:</span><span class="at"> fs.rf</span></span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">cls</span><span class="kw">:</span><span class="at"> class</span></span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">pars</span><span class="kw">:</span></span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">fs.rf</span><span class="kw">:</span></span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">nreps</span><span class="kw">:</span><span class="at"> </span><span class="dv">100</span></span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">nCores</span><span class="kw">:</span><span class="at"> </span><span class="dv">4</span></span>
<span id="cb55-47"><a href="#cb55-47" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">clusterType</span><span class="kw">:</span><span class="at"> FORK</span></span>
<span id="cb55-48"><a href="#cb55-48" aria-hidden="true" tabindex="-1"></a><span class="fu">correlations</span><span class="kw">:</span></span>
<span id="cb55-49"><a href="#cb55-49" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">method</span><span class="kw">:</span><span class="at"> pearson</span></span>
<span id="cb55-50"><a href="#cb55-50" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">pAdjustMethod</span><span class="kw">:</span><span class="at"> bonferroni</span></span>
<span id="cb55-51"><a href="#cb55-51" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">corPvalue</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.05</span></span></code></pre></div>
<p>This can be passed directly into an <code>AnalysisParameters</code> object using the following:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">paramFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">'defaultParameters.yaml'</span>,package <span class="op">=</span> <span class="st">'metabolyseR'</span><span class="op">)</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parseParameters.html">parseParameters</a></span><span class="op">(</span><span class="va">paramFile</span><span class="op">)</span></code></pre></div>
<p>For more complex pre-treatment situations such as the following:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pre-treatment</span><span class="kw">:</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">remove</span><span class="kw">:</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">sample</span><span class="kw">:</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">idx</span><span class="kw">:</span><span class="at"> fileOrder</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">samples</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">remove1</span><span class="kw">:</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">class</span><span class="kw">:</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">cls</span><span class="kw">:</span><span class="at"> day</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">classes</span><span class="kw">:</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> H</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">occupancyFilter</span><span class="kw">:</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">maximum</span><span class="kw">:</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">cls</span><span class="kw">:</span><span class="at"> class</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">occupancy</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.667</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">transform</span><span class="kw">:</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">TICnorm</span><span class="kw">:</span><span class="at"> </span><span class="ch">~</span></span></code></pre></div>
<p>Where multiple steps of the same method needed (here is <code>remove</code>), these are numbered sequentially. Where multiple values also need to be provided to a particular argument (e.g.Â <code>classes = c('H','1')</code>), these should be supplied as a hyphenated list.</p>
<p>Existing <code>AnalysisParameters</code> objects can also be exported to YAML format as shown below:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analysisParameters.html">analysisParameters</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/parseParameters.html">exportParameters</a></span><span class="op">(</span><span class="va">p</span>,file <span class="op">=</span> <span class="st">'analysis_parameters.yaml'</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="performing-an-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#performing-an-analysis" class="anchor"></a>Performing an analysis</h3>
<p>The analysis is performed in a single step using the <code><a href="../reference/metabolyse.html">metabolyse()</a></code> function. This accepts the metabolomic data, the sample information and the analysis parameters.</p>
<p>The metabolomic data table of abundance values where the columns are the metabolome features and the rows are each sample observation. Similarly, the sample meta-information table should consist of the observations as rows and the meta information as columns. <strong>The order of the observation rows of the sample information table should be concordant with the rows in the metabolomics data table.</strong></p>
<p>We can run an example analysis using the <code>abr1</code> data set by first generating the default parameters for pre-treatment and modelling (random forest) analysis elements.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analysisParameters.html">analysisParameters</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'pre-treatment'</span>,<span class="st">'modelling'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Custom pre-treatment parameters can then be specified to only inlude occupancy filtering and total ion count normalisation.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/parameters.html">parameters</a></span><span class="op">(</span><span class="va">p</span>,<span class="st">'pre-treatment'</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/preTreatmentElements.html">preTreatmentParameters</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  occupancyFilter <span class="op">=</span> <span class="st">'maximum'</span>,
  transform <span class="op">=</span> <span class="st">'TICnorm'</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Next the <code>cls</code> parameters can be changed to use the <code>day</code> sample information column throughout the analysis.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">changeParameter</span><span class="op">(</span><span class="va">p</span>,<span class="st">'cls'</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">'day'</span></code></pre></div>
<p>Finally, the analysis can be run in a single step. Here only the fist 200 features of the negative ionisation mode data are specified to reduce the analysis time needed for this example.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/metabolyse.html">metabolyse</a></span><span class="op">(</span><span class="va">abr1</span><span class="op">$</span><span class="va">neg</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">]</span>,<span class="va">abr1</span><span class="op">$</span><span class="va">fact</span>,<span class="va">p</span><span class="op">)</span> </code></pre></div>
<pre><code>## 
## metabolyseR  v0.14.4 Sun Nov  7 22:26:41 2021</code></pre>
<pre><code>## ________________________________________________________________________________</code></pre>
<pre><code>## Parameters:
## pre-treatment
##  occupancyFilter
##      maximum
##          cls = day
##          occupancy = 2/3
##  transform
##      TICnorm
## 
## modelling
##  randomForest
##      cls = day
##      rf = list()
##      reps = 1
##      binary = FALSE
##      comparisons = list()
##      perm = 0
##      returnModels = FALSE
##      seed = 1234</code></pre>
<pre><code>## ________________________________________________________________________________</code></pre>
<pre><code>## Pre-treatment â€¦

Pre-treatment   âœ“ [0.8S]
## Modelling â€¦

Modelling   âœ“ [3.3S]
## ________________________________________________________________________________
## 
## Complete! [4S]</code></pre>
<p><strong>Note: If a data pre-treatment step is not performed prior to modelling or correlation analysis, the raw data will automatically be used.</strong></p>
<p>The <code>analysis</code> object containing the analysis results can be printed to provide some basic information about the results of the analysis.</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">analysis</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## metabolyseR v0.14.4
## Analysis:
##  Sun Nov  7 22:26:41 2021
## 
##  Raw Data:
##      No. samples = 120
##      No. features = 200
## 
##  Pre-treated Data:
##      Sun Nov  7 22:26:42 2021
##      No. samples = 120
##      No. features = 48
## 
##  Modelling:
##      Sun Nov  7 22:26:45 2021
##      Methods: randomForest</code></pre>
</div>
<div id="performing-a-re-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#performing-a-re-analysis" class="anchor"></a>Performing a re-analysis</h3>
<p>There are likely to be occasions where an analysis will need to be re-analysed using a new set of parameters. This can be achieved using the <code><a href="../reference/metabolyse.html">reAnalyse()</a></code> function.</p>
<p>In the example below we will run a correlation analysis in addition to the pre-treatment and modelling elements already performed.</p>
<p>Firstly, we can specify the correlation parameters:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analysisParameters.html">analysisParameters</a></span><span class="op">(</span><span class="st">'correlations'</span><span class="op">)</span></code></pre></div>
<p>Then perform the re-analysis on our previously analysed <code>Analysis</code> object, specifying the additional parameters.</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/metabolyse.html">reAnalyse</a></span><span class="op">(</span><span class="va">analysis</span>,<span class="va">parameters</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## metabolyseR v0.14.4 Sun Nov  7 22:26:45 2021
## ________________________________________________________________________________
## Parameters:
## correlations
##  method = pearson
##  pAdjustMethod = bonferroni
##  corPvalue = 0.05
## ________________________________________________________________________________</code></pre>
<pre><code>## Correlations â€¦

Correlations    âœ“ [0.1S]</code></pre>
<pre><code>## ________________________________________________________________________________
## 
## Complete! [0.1S]</code></pre>
<p>An overview of the results of the analysis (now including correlations) can then be printed.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">analysis</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## metabolyseR v0.14.4
## Analysis:
##  Sun Nov  7 22:26:41 2021
## 
##  Raw Data:
##      No. samples = 120
##      No. features = 200
## 
##  Pre-treated Data:
##      Sun Nov  7 22:26:42 2021
##      No. samples = 120
##      No. features = 48
## 
##  Modelling:
##      Sun Nov  7 22:26:45 2021
##      Methods: randomForest
## 
##  Correlations:
##      Sun Nov  7 22:26:45 2021
##      No. correlations = 140</code></pre>
</div>
<div id="extracting-analysis-results" class="section level3">
<h3 class="hasAnchor">
<a href="#extracting-analysis-results" class="anchor"></a>Extracting analysis results</h3>
<p>An analysis performed by <code><a href="../reference/metabolyse.html">metabolyse()</a></code> returns an S4 object of class <code>Analysis</code>. There are a number of ways of extracting analysis results from this object.</p>
<p>Similarly to the <code>AnalysisData</code> class, the <code><a href="../reference/dat.html">dat()</a></code> and <code><a href="../reference/dat.html">sinfo()</a></code> functions can be used to extract the metabolomics data or sample information tables directly for either the <code>raw</code> or <code>pre-treated</code> data.</p>
<p>For example, to extract the pre-treated metabolomics data from our object <code>analysis</code>:</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/dat.html">dat</a></span><span class="op">(</span><span class="va">analysis</span>,type <span class="op">=</span> <span class="st">'pre-treated'</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 120 Ã— 48
##       N113    N115    N117    N118    N119    N127    N128    N129  N130    N131
##      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1 0.00646 0       1.68e-4 0       1.60e-3 0.0323  2.65e-4 2.80e-4     0 0      
##  2 0.0113  7.74e-4 1.02e-3 0       1.43e-3 0.00856 0       3.95e-4     0 0      
##  3 0.00931 6.01e-4 2.70e-3 6.22e-5 5.58e-3 0       0       1.05e-4     0 6.51e-4
##  4 0.00798 0       0       0       1.62e-4 0.00848 0       4.05e-4     0 1.28e-4
##  5 0.0105  0       0       0       0       0.00658 0       1.97e-3     0 0      
##  6 0.00454 0       2.48e-4 3.25e-4 5.31e-4 0.00207 0       1.98e-4     0 0      
##  7 0.0117  0       1.14e-3 0       4.39e-4 0.00603 0       4.04e-4     0 0      
##  8 0.00787 2.36e-3 1.43e-3 1.52e-4 4.22e-3 0.00290 2.78e-4 5.76e-5     0 0      
##  9 0.00136 1.87e-4 8.17e-4 1.87e-4 0       0.0610  1.31e-4 5.23e-4     0 0      
## 10 0.00899 4.26e-4 2.06e-3 0       8.36e-4 0.00106 7.72e-4 0           0 0      
## # â€¦ with 110 more rows, and 38 more variables: N132 &lt;dbl&gt;, N133 &lt;dbl&gt;,
## #   N134 &lt;dbl&gt;, N135 &lt;dbl&gt;, N136 &lt;dbl&gt;, N137 &lt;dbl&gt;, N139 &lt;dbl&gt;, N143 &lt;dbl&gt;,
## #   N145 &lt;dbl&gt;, N146 &lt;dbl&gt;, N147 &lt;dbl&gt;, N149 &lt;dbl&gt;, N153 &lt;dbl&gt;, N155 &lt;dbl&gt;,
## #   N157 &lt;dbl&gt;, N161 &lt;dbl&gt;, N163 &lt;dbl&gt;, N164 &lt;dbl&gt;, N165 &lt;dbl&gt;, N168 &lt;dbl&gt;,
## #   N169 &lt;dbl&gt;, N170 &lt;dbl&gt;, N171 &lt;dbl&gt;, N173 &lt;dbl&gt;, N174 &lt;dbl&gt;, N175 &lt;dbl&gt;,
## #   N179 &lt;dbl&gt;, N180 &lt;dbl&gt;, N181 &lt;dbl&gt;, N183 &lt;dbl&gt;, N187 &lt;dbl&gt;, N191 &lt;dbl&gt;,
## #   N192 &lt;dbl&gt;, N193 &lt;dbl&gt;, N195 &lt;dbl&gt;, N196 &lt;dbl&gt;, N197 &lt;dbl&gt;, N198 &lt;dbl&gt;</code></pre>
<p>Or to extract the raw sample information:</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/dat.html">sinfo</a></span><span class="op">(</span><span class="va">analysis</span>,type <span class="op">=</span> <span class="st">'raw'</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 120 Ã— 9
##    injorder pathcdf              filecdf name.org remark name    rep day   class
##       &lt;int&gt; &lt;fct&gt;                &lt;fct&gt;   &lt;fct&gt;    &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;fct&gt; &lt;int&gt;
##  1        1 C:/Xcalibur/ANDI-LTâ€¦ 01.cdf  12_2     ok     12_2      2 2         2
##  2        2 C:/Xcalibur/ANDI-LTâ€¦ 02.cdf  13_3     ok     13_4      3 3         3
##  3        3 C:/Xcalibur/ANDI-LTâ€¦ 03.cdf  15_4     ok     15_5      5 4         4
##  4        4 C:/Xcalibur/ANDI-LTâ€¦ 04.cdf  12_1     ok     12_2      2 1         1
##  5        5 C:/Xcalibur/ANDI-LTâ€¦ 05.cdf  12_2     ok     12_2      2 2         2
##  6        6 C:/Xcalibur/ANDI-LTâ€¦ 06.cdf  11_1     ok     11_2      1 1         1
##  7        7 C:/Xcalibur/ANDI-LTâ€¦ 07.cdf  14_2     ok     14_3      4 2         2
##  8        8 C:/Xcalibur/ANDI-LTâ€¦ 08.cdf  11_4     ok     11_5      1 4         4
##  9        9 C:/Xcalibur/ANDI-LTâ€¦ 09.cdf  13_H     ok     13_H      3 H         6
## 10       10 C:/Xcalibur/ANDI-LTâ€¦ 10.cdf  15_H     ok     15_H      5 H         6
## # â€¦ with 110 more rows</code></pre>
<p>Alternatively the <code>raw</code> or <code>preTreated</code> functions can be used to extract the <code>AnalysisData</code> class objects containing both the metabolomics data and sample information for the raw and pre-treated data respectively.</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/dat.html">raw</a></span><span class="op">(</span><span class="va">analysis</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## AnalysisData object containing:
## 
## Samples: 120 
## Features: 200 
## Info: 9</code></pre>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/dat.html">preTreated</a></span><span class="op">(</span><span class="va">analysis</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## AnalysisData object containing:
## 
## Samples: 120 
## Features: 48 
## Info: 9</code></pre>
<p>Lastly the <code>analysisResults</code> function can be used to extract the results of any of the analysis elements. The following will extract the modelling results:</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/dat.html">analysisResults</a></span><span class="op">(</span><span class="va">analysis</span>,element <span class="op">=</span> <span class="st">'modelling'</span><span class="op">)</span></code></pre></div>
<pre><code>## $randomForest
## 
## Random forest classification 
## 
## Samples:  120 
## Features:     48 
## Response:     day 
## # comparisons:    1</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jasen Finch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
